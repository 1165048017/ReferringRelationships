#!/usr/bin/env bash
CUDA_VISIBLE_DEVICES=3 python train.py --workers 8 --lr 0.0001 --epochs 30 --patience 3 --lr-reduce-rate 0.7 --opt rms --loss-func weighted --w1 7.5 --batch-size 64 --dropout 0. --heatmap-threshold 0.5 --hidden-dim 1024 --embedding-dim 512 --num-predicates 70 --num-objects 100 --cnn resnet --nb-conv-im-map 0 --conv-im-kernel 0 --nb-conv-att-map 6 --conv-predicate-kernel 7 --conv-predicate-channels 10 --feat-map-dim 14 --feat-map-layer activation_40 --train-data-dir /data/ranjaykrishna/ReferringRelationships/data/dataset-visualgenome-14/train --val-data-dir /data/ranjaykrishna/ReferringRelationships/data/dataset-visualgenome-14/val --test-data-dir /data/ranjaykrishna/ReferringRelationships/data/dataset-visualgenome-14/test --use-models-dir --models-dir /data/chami/ReferringRelationships/models/VisualGenome/11_14_2017_bis/sym_ssn --iterations 3 --model sym_ssn --use-predicate 1 --output-dim 14 --categorical-predicate --internal-loss-weight 1. --use-internal-loss --finetune-cnn #--baseline-weights /data/chami/ReferringRelationships/models/VRD/11_13_2017/baseline_no_predicate/1/model22-4.14.h5 

